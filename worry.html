<!DOCTYPE html>
<html>
    <body>
        <img
      src="/images/back.png"
      style="width: 2rem; height: 2rem;"
      onclick="document.getElementById('fBack').submit();"
    />
    <div style="display:flex; justify-content:center">
        <span id="message" style="text-align:center"></span>
    </div><br>
        <form
      id="fBack"
      action="/home"
      method="POST"
      onsubmit="return false;"
    ></form>
        <header style="color: red">How many minutes did you spend worrying today?</header>
        <form id="form" action="/worryPosted" method="POST" onsubmit="return false;">
            <div style="display:flex; justify-content: center; text-align:center">
                <img id="prev" class="arrow" src="/images/previous.png">
                <div id="date" style="text-align: center;">
                    <label id="currDay" for="day"></label>
                    <input type="date" id="day" name="day">
                </div>
                <img id="next" class="arrow" src="/images/next.png">
            </div>
            <div class="inp-border a1" style="margin-left: calc(50% - 200px);">
                <input class="input" step=".01" id="worry" type="number" name="worry">
            </div>
        </form>
        <div id="images">
            <img id="worryFace" src="/worries/Asset 6.svg" alt="worryFace">
        </div>

		<style>
            .arrow {
                width:30px;
                margin-left:5px;
                margin-right:5px;
            }
            #new {
                width:10%;
                position: absolute;
                top: 0%;
                left: 30%;
            }
            #images {
                position: relative;
                top: 0;
                left: 0;
            }
            .input {
                text-align: center;
                padding: 15px;
                outline: none;
                border: double 0;
                background: white;
                border-radius: 67px;
                position: relative;
                box-sizing: border-box;
                display: block;
                width: 100%;
            }
            .inp-border {
                padding: 5px;
                margin: 2vh 1vh;
                border-radius: 67px;
                max-width: 400px;
            }
            body {
                background: rgb(225, 225, 225);
            }
			#worryFace{
                width:35%;
				display: block;
				margin-left: auto;
				margin-right: auto;
                position: relative;
			}
			header{
				text-align: center;
				font-size: 250%;
				margin-bottom: 20px;
			}
			input{
                font-size: 17px;
				display: block;
				margin-left: auto;
				margin-right: auto;
				margin-top: auto;
				width: auto;
			}
            .a1 {
                background: linear-gradient(
                    330.28deg,
                    #0324ff 100%,
                    #455dff 100%,
                    #0c8ffa 100%
                );
            }
            .a1 > input {
                color: black;
            }
            .a1 > input::placeholder {
                color: black;
                opacity: 0.6;
            }
            .inp-border:focus-within {
                background: linear-gradient(
                330.28deg,
                #0339fc 0%,
                #335df5 30.73%,
                #00bbff 55.73%,
                #54d1ff 79.17%,
                #00eeff 100%
                );
            }
            .inp-border:hover {
                background: linear-gradient(
                330.28deg,
                #0339fc 0%,
                #335df5 30.73%,
                #00bbff 55.73%,
                #54d1ff 79.17%,
                #00eeff 100%
                );
            }
            .a1:hover > input::placeholder {
                color: white;
            }
		</style>
		<script>
            document.getElementById("day").onchange = function() {
                let newDate = new Date(document.getElementById("day").value)
                currDate.setDate(newDate.getDate() + 1);
                setDate();
            }
            var currDate = new Date();
            function setDate() {
                let s = currDate.toLocaleDateString();
                let day = currDate.getDate();
                let year = currDate.getFullYear();
                let month = currDate.getMonth() + 1;
                if (day.toString().length == 1) {
                    day = "0" + day.toString();
                }
                if (month.toString().length == 1) {
                    month = "0" + month.toString();
                }
                document.getElementById('day').value = year + '-' + month + '-' + day;
                document.getElementById('currDay').innerHTML = weekday[currDate.getDay()];
            }
            const weekday = [
                "Sunday",
                "Monday",
                "Tuesday",
                "Wednesday",
                "Thursday",
                "Friday",
                "Saturday"
            ];
            document.getElementById("next").onclick = function() {
                currDate.setDate(currDate.getDate() + 1);
                setDate();
            }
            document.getElementById("prev").onclick = function() {
                currDate.setDate(currDate.getDate() - 1);
                setDate();
            }
            setDate();
            document.addEventListener("keydown", function(event) {
				if (event.keyCode == 13 && !isNaN(document.getElementById("worry").value)) {
                    var sound = new Audio("/images/stress.mp3");
                    sound.currentTime = 0;
                    sound.play();
                    if (document.getElementById("worry").value <= 15) {
                        let idx = Math.floor(Math.random() * 3);
                        var src;
                        if (idx == 0) {
                            src = '/comments/Awesome.svg';
                        } else if (idx == 1) {
                            src = '/comments/Great job.svg';
                        } else {
                            src = '/comments/Nice work.svg';
                        }
                        document.getElementById("images").innerHTML = "<img id='worryFace' src='/worries/Asset 6.svg' alt='worryFace'> <img src=\"" + src +  "\"id='new'>"
                    } else {
                        document.getElementById("images").innerHTML = "<img id='worryFace' src='/worries/Asset 6.svg' alt='worryFace'>";
                    }

					var image = document.getElementById("worryFace");
					if(document.getElementById("worry").value >= 60) {
						image.src = "/worries/Asset 1.svg";
					}
					else if(document.getElementById("worry").value >=45) {
						image.src = "/worries/Asset 2.svg";
					}
					else if(document.getElementById("worry").value >= 30) {
						image.src = "/worries/Asset 3.svg";
					}
					else if(document.getElementById("worry").value >= 15) {
						image.src = "/worries/Asset 4.svg";
					}
					else if(document.getElementById("worry").value >= 5) {
						image.src = "/worries/Asset 5.svg"; 
					}
					else if(document.getElementById("worry").value != ""){
						image.src = "/worries/Asset 6.svg";
					}
                    let w = document.getElementById("worry").value;
                    if (w == "" || isNaN(w) || document.getElementById("day").value == "") {
                        document.getElementById("message").style.color="red";
                        document.getElementById("message").innerHTML="There was an Error Submitting the Form";
                    } else {
                        document.getElementById("form").submit();
                        document.getElementById("message").style.color="green";
                        document.getElementById("message").innerHTML="Form Successfully Submitted";
                    }
				}
			});
		</script>
    </body>
</html>