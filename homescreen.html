<html>
    <body>
        <form id="form" action="/water" method="POST" onsubmit="return false;"></form>
        <form id="form2" action="/frog" method="POST" onsubmit="return false;"></form>
        <form id="form3" action="/nutrition" method="POST" onsubmit="return false;"></form>
        <form id="form4" action="/sleep" method="POST" onsubmit="return false;"></form>
        <form id="form5" action="/worry" method="POST" onsubmit="return false;"></form>
        <form id="form6" action="/movement" method="POST" onsubmit="return false"></form>
        <form id="results" action="/team" method="POST" onsubmit="return false;"></form>
        <form id="lol" action="/home" method="POST" onsubmit="return false;"></form>
        <form id="icon" action="/changeIcon" method="POST" onsubmit="return false"></form>
        <div class="mute">
            <img id="mute__toggle" src="/images/speaker.png" onclick="changeIcon()">
        </div>
        <div class="hamburger-menu">
            <input id="menu__toggle" type="checkbox" />
            <label class="menu__btn" for="menu__toggle">
              <span></span>
            </label>
        
            <ul class="menu__box">
              <li><a class="menu__item" href="#" onclick="document.getElementById('lol').submit();">Home</a></li>
              <li><a class="menu__item" href="#" onclick="exit3();">Data</a></li>
              <li><a class="menu__item" href="#">Streaks</a></li>
            </ul>
        </div><br><br>

        <div id="box">
            <div id="welcome">
                <div id="w">
                    <div id="welc">Welcome Back!</div>
                </div>
                <div id="streak-container">
                    <div id="cur" name="cur">Current Streak<br><br>
                        <label id="lcur"></label>
                    </div>
                    <img id="imgh" src="/images/hiker.svg">
                    <div id="max">Max Streak<br><br>
                        <label id="lmax"></label>
                    </div>
                </div>
            </div>

            <div id="apps">
                <div class='row'>
                    <figure onclick='exit();'>
                        <img class="img" src='/images/water.png'>
                    </figure>
                    <figure onclick='exit2();'>
                        <img class="img" src='/images/frog.png'>
                    </figure>
                    <figure onclick='exit5();'>
                        <img class="img" src='/images/sleep icon.svg'>
                    </figure>
                </div>
                <div class='row'>
                    <figure onclick='exit6();'>
                        <img class="img" src='/images/worry icon-red.svg'>
                    </figure>
                    <figure onclick='exit4();'>
                        <img class="img" src='/images/nutrition icon2.svg'>
                    </figure>
                    <figure onclick='exit7();'>
                        <img class="img" src='/images/movement Icon.svg'>
                    </figure>
                </div>
            </div>

            <div id="map">
                <img id="hike" src="/images/Trail V2.svg">
            </div>

            <div id="month">
                <header id="m" style="font-size:25px;text-align: center"></header>
                <div class="combo">
                    <span style="margin-left:10px;">Water</span>
                    <div class="inner">
                    </div>
                </div>
                <div class="combo">
                    <span style="margin-left:10px;">Frog</span>
                    <div class="inner">
                    </div>
                </div>
                <div class="combo">
                    <span style="margin-left:10px;">Sleep</span>
                    <div class="inner">
                    </div>
                </div>
                <div class="combo">
                    <span style="margin-left:10px;">Worry</span>
                    <div class="inner">
                    </div>
                </div>
                <div class="combo">
                    <span style="margin-left:10px;">Nutrition</span>
                    <div class="inner">
                    </div>
                </div>
                <div class="combo">
                    <span style="margin-left:10px;">Movement</span>
                    <div class="inner">
                    </div>
                </div>
            </div>
        </div>
    </body>

    <style>
        #mute__toggle {
            position: absolute;
            width:2%;
        }
        #imgh {
            position: absolute;
            width:4rem;
            height:4rem;
            margin-top:1%;
        }
        #hike {
            height: 100%;
            width: 100%;
        }
        #w {
            display: flex;
            justify-content: center;
        }
        label {
            font-size: 20px;
        }
        #cur {
            background-color: rgb(208, 208, 208);
            width:20%;
            height: 70%;
            border-radius: 20px;
            margin-right: 20%;
            font-size: 20px;
            text-align: center;
        }
        #max {
            background-color: rgb(208, 208, 208);
            width:20%;
            height: 70%;
            border-radius: 20px;
            margin-left: 20%;
            font-size: 20px;
            text-align: center;
        }
        #welc {
            text-align: center;
            font-size: 15px;
            margin-top: 1%;
            height:13%;
            width:70%;
        }
        #streak-container {
            height:100%;
            width:100%;
            display: flex;
            justify-content: center;
            border-radius: 25px;
        }
        .row {
            resize:none;
            display:flex;
            justify-content:center;
        }
        #apps {
            grid-column: 50 / 101;
            grid-row: 1 / 20;
            background-color: rgb(235, 235, 235);
            border-radius:20px;
            margin: 0.5%;
        }
        #welcome {
            resize:none;
            grid-column: 1 / 50;
            grid-row: 1 / 15;
            background-color: rgb(235, 235, 235);
            border-radius:20px;
            margin: 0.5%;
        }
        .inner {
            resize:none;
            width: 100%;
            height: 100%;
            background-color: rgb(200, 200, 200);
            border-radius: 20px;
            display: grid;
            justify-content: center;
            grid-template-columns: repeat(7, min-content);
            grid-column-gap: 8%;
        }

        .inner > div {
            margin: none;
            align-items: center;
            text-align: center;
            border-radius: 50%;
            width:30px; 
            height:30px;
        }
        .combo {
            width: 85%;
            height: 15%;
            margin:5%;
            border-radius: 20px;
        }
        #map {
            resize:none;
            grid-column: 1 / 50;
            grid-row: 15 / 70;
            border-radius: 25px;;
            margin: 0.5%;
            overflow: auto;
            width: 99%;
            height: 99%;
        }
        #month {
            resize:none;
            grid-column: 50 / 101;
            grid-row: 20 / 70;
            border-radius: 20px;
            overflow: auto;
            background-color: rgb(235, 235, 235);
            margin: 0.5%;
        }
        #box {
            resize:none;
            width: 100%;
            height: 95%;
            display: grid;
            gap: 10px;
        }
        body {
            font-family: 'Courier New', Courier, monospace;
            background: linear-gradient(0deg,rgba(2, 0, 36, 1) 0%,rgba(17, 17, 236, 1) 0%,rgba(0, 212, 255, 1) 35%);
        }
        ::-webkit-scrollbar {
            width: 6px;
        }
     
        ::-webkit-scrollbar-track {
            background: gainsboro;
            border-radius: 5px;
        }
     
        ::-webkit-scrollbar-thumb {
            background: rgb(0, 120, 239);
            border-radius: 5px;
        }
     
        ::-webkit-scrollbar-thumb:hover {
            background: rgb(0, 78, 94);
        }
        .hamburger-menu {
            float: right;
        }
        #menu__toggle {
            opacity: 0;
        }
        #menu__toggle:checked + .menu__btn > span {
            transform: rotate(45deg);
        }
        #menu__toggle:checked + .menu__btn > span::before {
            top: 0;
            transform: rotate(0deg);
        }
        #menu__toggle:checked + .menu__btn > span::after {
            top: 0;
            transform: rotate(90deg);
        }
        #menu__toggle:checked ~ .menu__box {
            left: 0 !important;
        }
        .menu__btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 26px;
            height: 26px;
            cursor: pointer;
            z-index: 1;
        }
        .menu__btn > span,
        .menu__btn > span::before,
        .menu__btn > span::after {
            display: block;
            position: absolute;
            width: 100%;
            height: 2px;
            background-color: #616161;
            transition-duration: .25s;
        }
        .menu__btn > span::before {
            content: '';
            top: -8px;
        }
        .menu__btn > span::after {
            content: '';
            top: 8px;
        }
        .menu__box {
            display: block;
            position: fixed;
            top: 0;
            left: 100%;
            width: 300px;
            height: 100%;
            margin: 0;
            margin-left:85%;
            padding: 80px 0;
            list-style: none;
            background-color: #ECEFF1;
            box-shadow: 2px 2px 6px rgba(0, 0, 0, .4);
            transition-duration: .25s;
        }
        .menu__item {
            display: block;
            padding: 12px 24px;
            color: #333;
            font-family: 'Roboto', sans-serif;
            font-size: 20px;
            font-weight: 600;
            text-decoration: none;
            transition-duration: .25s;
        }
        .menu__item:hover {
            background-color: #CFD8DC;
        }
        figure {
            text-align:center;
            margin: 4%;
            margin-left: 10%;
            margin-right: 10%;
        }
        .img {
            border-radius: 5px;
            width: 80px;
            height: width;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script>
        var datesForChecking = []
        const days = ["S", "M", "T", "W", "T", "F", "S"];
        let today = new Date();
        let dates = [];
        let nums = [];
        for (let i = 0; i < 7; i++) {
            datesForChecking.push(fixDate(today))
            dates.push(days[today.getDay()]);
            nums.push(today.getDate());
            today.setDate(today.getDate() - 1);
        }
        dates.reverse();
        nums.reverse();
        datesForChecking.reverse();

        let inners = document.getElementsByClassName("inner");
        for (let i = 0; i < inners.length; i++) {
            for (let j = 0; j < 7; j++) {
                inners[i].innerHTML += "<div>" + dates[j] + "</div>";
            }
        }
        for (let i = 0; i < inners.length; i++) {
            for (let j = 0; j < 7; j++) {
                inners[i].innerHTML += "<div id='n" + i + "" + j +"'>" + nums[j] + "</div>";
            }
        }

        function setIcon(swap){
            $.ajax({
                type: "POST",
                url: "/getMuteStatus",
                dataType: "text",
                success: function(result){
                    let image = document.getElementById("mute__toggle");
                    let muted;
                    if (result == "true") {
                        muted = true;
                    } else {
                        muted = false;
                    }
                    if (swap) {
                        muted = !muted;
                    }
                    if (muted){
                        image.src = "/images/mute.png";
                    } else {
                        image.src = "/images/speaker.png";
                    }
                }
            });
        }

        function changeIcon(){
            document.getElementById("icon").submit();
            setIcon(false);
        }

        function fixDate(date) {
            let year = date.getFullYear().toString();
            let month = (date.getMonth() + 1).toString();
            let day = date.getDate().toString()

            if (month.length == 1) {
                month = "0" + month;
            }
            if (day.length == 1) {
                day = "0" + day;
            }
            return year + "-" + month + "-"+ day;
        }  
    </script>
    <script type="text/javascript">
        const CSVToArray = (data) =>
              data
                .slice(data.indexOf("\n") + 1)
                .split("\n")
                .map((v) => v.split(","));
        const month = ["January","February","March","April","May","June","July","August","September","October","November","December"];
        var t = new Date();
        document.getElementById("m").innerHTML = month[t.getMonth()];
        var max = "";
        var cur = "";
        var name;
        function run() {
            setIcon(true);
            $.ajax({
                type: "POST",
                url: "/getName",
                dataType: "text",
                success: function (content) {
                    name = content;
                }
            });
            $.ajax({
                type: "POST",
                url: "/getMaxAndMin",
                dataType: "text",
                success: function (content) {
                    let gap = content.indexOf(" ");
                    cur = content.slice(0, gap);
                    max = content.slice(gap + 1);
                    document.getElementById("lcur").innerHTML = cur + " days";
                    document.getElementById("lmax").innerHTML = max + " days";
                }
            });
            $.ajax({
                type: "POST",
                url: "/getdata",
                dataType: "text",
                success: function (content) {
                    var allData = content.split("\n");
                    var fillWater = [false, false, false, false, false, false, false];
                    var fillFrog = [false, false, false, false, false, false, false];
                    var fillSleep = [false, false, false, false, false, false, false];
                    var fillWorry = [false, false, false, false, false, false, false];
                    var fillNutrition = [false, false, false, false, false, false, false];
                    var fillMovement = [false, false, false, false, false, false, false];
                    for (let i = 0; i < datesForChecking.length; i++) {
                        var recentName = "";
                        for (let j = 0; j < allData.length; j++) {
                            if (allData[j][0] && allData[j][0] == "*") {
                                recentName = allData[j].slice(1, name.length + 1);
                            }
                            if (allData[j][0] && allData[j][0] != "*" && name == recentName) {
                                let currRow = CSVToArray(allData[j])[0];
                                if (datesForChecking[i] == currRow[0]) {
                                    if (currRow[1] != " ") {
                                        fillWater[i] = true;
                                    }
                                    if (currRow[2] != " ") {
                                        fillFrog[i] = true;
                                    }
                                    if (currRow[3] != " ") {
                                        fillSleep[i] = true;
                                    }
                                    if (currRow[4] != " ") {
                                        fillWorry[i] = true;
                                    }
                                    if (currRow[5] != " ") {
                                        fillNutrition[i] = true;
                                    }
                                    if (currRow[6] != " ") {
                                        fillMovement[i] = true;
                                    }
                                }
                            }
                        }
                    }

                    for (let i = 0; i < fillWater.length; i++) {
                        if (fillWater[i]) {
                            document.getElementById("n0" + i).style.background = "#6fd9ff";
                        }
                    }
                    for (let i = 0; i < fillFrog.length; i++) {
                        if (fillFrog[i]) {
                            document.getElementById("n1" + i).style.background = "rgb(130, 255, 130)";
                        }
                    }
                    for (let i = 0; i < fillSleep.length; i++) {
                        if (fillSleep[i]) {
                            document.getElementById("n2" + i).style.background = "rgb(117, 18, 255)";
                        }
                    }
                    for (let i = 0; i < fillWorry.length; i++) {
                        if (fillWorry[i]) {
                            document.getElementById("n3" + i).style.background = "rgb(255, 130, 130)";
                        }
                    }
                    for (let i = 0; i < fillNutrition.length; i++) {
                        if (fillNutrition[i]) {
                            document.getElementById("n4" + i).style.background = "rgb(105, 68, 23)";
                        }
                    }
                    for (let i = 0; i < fillMovement.length; i++) {
                        if (fillMovement[i]) {
                            document.getElementById("n5" + i).style.background = "rgb(255, 190, 85)";
                        }
                    }
                }
                });
            }
        run();
    </script>
    <script type="text/javascript">
        function exit() {
            document.getElementById("form").submit();
        }
        function exit2() {
            document.getElementById("form2").submit();
        }
        function exit3() {
            document.getElementById("results").submit();
        }
        function exit4() {
            document.getElementById("form3").submit();
        }
        function exit5() {
            document.getElementById("form4").submit();
        }
        function exit6() {
            document.getElementById("form5").submit();
        }
        function exit7() {
            document.getElementById("form6").submit();
        }
    </script>
</html>